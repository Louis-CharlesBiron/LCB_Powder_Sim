#!/usr/bin/env node
import{exec}from"child_process";import{mkdirSync,writeFileSync}from"fs";import{createRequire}from"module";import{join}from"path";import{createInterface}from"readline";const PARAM=process.argv[2]?process.argv[2].startsWith("-")?process.argv[2].replace("-",""):process.argv[2]:"",DEST=join(process.cwd(),PARAM),PACKAGE_JSON=createRequire(import.meta.url)("../package.json"),PACKAGE_NAME=PACKAGE_JSON.name,VERSION=PACKAGE_JSON.version;try{mkdirSync(DEST,{recursive:!0})}catch{}writeFileSync(join(DEST,"index.html"),'\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>LCB Powder Simulation | UMD Template</title>\n  <link rel="stylesheet" href="index.css">\n</head>\n  <body>\n    <canvas id="simulationCanvasId"></canvas>\n\n    <script type="module" src="index.js"><\/script>\n  </body>\n</html>\n'.trim()),writeFileSync(join(DEST,"index.css"),"\nhtml, body {\n    width: 100%;\n    height: 100%;\n    background-color: black;\n    color: aliceblue;\n    overflow: hidden;\n    margin: 0;\n    padding: 0;\n}".trim()),writeFileSync(join(DEST,"index.js"),`\nimport { Simulation } from "${PACKAGE_NAME}"\n\n// Creating the powder simulation\nconst simulation = new Simulation(\n    document.getElementById("simulationCanvasId"),\n    onSimulationReady,\n    {\n        usesWebWorkers: false,\n        autoStart: true,\n        aimedFPS: 60,\n    },\n    {\n        autoSimulationSizing: true,\n        showBorder: true,\n        showGrid: true,\n        visualEffectsEnabled: true,\n    }\n)\n\n// Function that runs when the simulation is loaded\nfunction onSimulationReady(simulation) {\n    console.log("The simulation is ready!")\n}\n`.trim()),writeFileSync(join(DEST,".gitignore"),"\nnode_modules\n.vscode/*\n.idea\n.DS_Store\n".trim()),writeFileSync(join(DEST,"package.json"),`\n{\n    "name": "project_template",\n    "version": "1.0.0",\n    "main": "index.js",\n    "type": "module",\n    "scripts": {\n      "dev": "vite"\n    },\n    "dependencies": {\n      "${PACKAGE_NAME}": "^${VERSION}"\n    },\n    "devDependencies": {\n      "vite": "^7.3.1"\n    }\n}`.trim()),console.log("\nLCB Powder Simulator: ESM project template successfully created at '"+DEST+"'!"),console.log("Don't forget to run 'npm install'.\n");const cli=createInterface({input:process.stdin,output:process.stdout});cli.question("Open in explorer [Y/N]?  ",value=>{const v=value?.toLowerCase()?.trim();["code","c"].includes(v)?exec("code --new-window "+DEST):v&&!["y","yes","ye","ok","for sure"].includes(v)||exec("explorer "+DEST),cli.close()}),process.stdin.on("keypress",(_,key)=>{"escape"==key.name&&cli.close()});